### README.md

# Replication Artifact for "Minimising Patches For Memory Safety Errors Due to Null Pointer Exceptions Using Incorrectness Separation Logic"

This repository contains the benchmark data, analysis scripts, and generated patches for the MSc thesis project "Monobrow". The goal of this artifact is to ensure the full reproducibility of the evaluation results presented in the paper.

## Abstract

Automated Program Repair (APR) for Null Pointer Exceptions (NPEs) is often hindered by imprecise fault localisation. Many tools rely on over-approximate analyses, leading to bloated, incorrect, and even unsafe patches that may fix non-existent bugs. This paper argues that precision is key and introduces Monobrow, a novel APR tool built on the under-approximate foundation of Incorrectness Separation Logic (ISL). We formalise NPE mitigation as a minimal, alias-aware AST transformation problem, solved via two canonical transformation schemas (Skip and Replace) and a novel three-stage compaction algorithm that finds Pareto-optimal patches on metrics we developed to quantitatively measure minimality. Our two-phased evaluation, first on a targeted NPEs, then a comparative analysis against state-of-the-art tools on real-world projects, shows that Monobrow generates patches that are demonstrably more minimal and safer for many classes of NPEs. Crucially, our ISL-based approach is immune by construction to fixing false positives — a critical failure mode we observed in competitor tools — which in the worst case introduced new vulnerabilities due to this. We conclude that under-approximate analysis provides a sound foundation for a new generation of trustworthy and precise APR tools.

## Monobrow Tool Source Code

The source code for the Monobrow tool itself is **not** in this repository. Monobrow is built as an extension to the Infer static analyzer. Our full implementation is hosted on a fork of Infer.

*   **Source Code Repository:** [**https://github.com/RaghavRoy145/infer/tree/repair**](https://github.com/RaghavRoy145/infer/tree/repair)

The tool can be built by following the standard build instructions for Infer.

## Repository Structure

This artifact repository contains the scripts and data used to generate the figures and tables in the paper's Evaluation section.

*   `results.csv`: The primary data file containing aggregated metrics and manual analysis results for every patch generated by Monobrow, FootPatch, and EffFix.
*   `visualiser-quant.py`: Python script to generate the quantitative analysis plots (e.g., the Pareto plot).
*   `visualiser-qual.py`: Python script to generate the qualitative analysis plots (e.g., correctness summary, bug overlap Venn diagram).
*   `patch_analyser.py`: A utility script used for analyzing and comparing patch files.
  
### Data Directories

*   `/patches/`: Contains patches generated by our tool, **Monobrow**.
*   `/efffix_generated/`: Contains patches generated by the **EffFix** tool.
*   `/footpatch_generated/`: Contains patches generated by the **FootPatch** tool.
*   `/source/`: Contains the original source code of the benchmarked programs.
*   `/manifests/`: Contains manifests detailing the bugs and their locations.

### Generated Figures

*   `unified_pareto_comparison.png`: The Pareto plot comparing patch minimality (RQ1).
*   `correctness_summary_openssl_only.png`: The stacked bar chart of patch correctness (RQ2).
*   `bug_overlap_venn.png`: The Venn diagram showing the overlap of bugs fixed by each tool.

## Prerequisites

The analysis scripts require Python 3.8+ and a few common data science libraries.

```bash
pip install pandas matplotlib seaborn
```

## How to Reproduce the Figures

The figures from the paper can be regenerated by running the visualisation scripts. The scripts will read the `results.csv` file and output the corresponding `.png` images.

### 1. Generate Quantitative Plots (RQ1)

This script generates the Pareto plot (`unified_pareto_comparison.png`) that compares the minimality of patches based on our cost model.

```bash
python3 visualiser-quant.py
```

### 2. Generate Qualitative Plots (RQ2)

This script generates the figures related to patch safety and correctness.

```bash
python3 visualiser-qual.py
```
This will produce:
*   `correctness_summary_openssl_only.png`: The stacked bar chart.
*   `bug_overlap_venn.png`: The Venn diagram.

